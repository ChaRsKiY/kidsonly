# Cron Job Setup для Parndorf Hours

## Обзор

Система автоматически обновляет данные о часах работы Parndorf каждый день в 9:00 утра по венскому времени с помощью крон-джобов.

## Как это работает

### 1. Автоматическое обновление
- **Расписание**: Каждый день в 9:00 AM (Europe/Vienna timezone)
- **Источник данных**: Сайт parndorffashionoutlet.com
- **Кэширование**: Данные сохраняются в памяти приложения

### 2. API Endpoints

#### GET `/api/parndorf/hours`
- Возвращает кэшированные данные
- Не выполняет скрапинг в реальном времени
- Быстрый ответ

#### POST `/api/parndorf/hours`
- Принудительное обновление данных
- Очищает кэш и получает свежие данные
- Используется только для тестирования

### 3. Структура данных

```json
{
  "success": true,
  "data": {
    "openingHours": [
      {
        "day": "Montag – Donnerstag",
        "hours": "9:30-19:00 Uhr"
      },
      {
        "day": "Freitag", 
        "hours": "9:30-20:00 Uhr"
      },
      {
        "day": "Samstag",
        "hours": "9:00-18:00 Uhr"
      },
      {
        "day": "Sonn- und Feiertage",
        "hours": "Geschlossen"
      }
    ],
    "lastUpdated": "2025-10-23T09:00:00.000Z"
  },
  "cached": true,
  "lastUpdate": "2025-10-23T09:00:00.000Z"
}
```

## Тестирование

### 1. Тестовая страница
Перейдите на `/test-api` для интерактивного тестирования:
- Получение кэшированных данных (GET)
- Принудительное обновление (POST)

### 2. Тест крон-джоба
```bash
npm run test-cron
```
Запускает тестовый крон-джоб каждые 10 секунд.

### 3. Логи
Крон-джоб выводит логи в консоль:
```
Starting initial Parndorf hours scraping...
Cron job scheduled for daily updates at 9:00 AM Vienna time
Running scheduled Parndorf hours update at 9:00 AM...
Parndorf hours updated successfully: {...}
```

## Преимущества

1. **Производительность**: API отвечает мгновенно, используя кэшированные данные
2. **Надежность**: Данные обновляются автоматически без вмешательства человека
3. **Экономия ресурсов**: Скрапинг выполняется только раз в день
4. **Время**: Обновление в 9:00 утра, когда сайт обычно стабилен

## Мониторинг

Для мониторинга работы крон-джоба проверяйте:
- Логи приложения
- Время последнего обновления в API ответе
- Статус кэша через `/test-api`

## Настройка расписания

Для изменения расписания отредактируйте файл `src/lib/scheduler.ts`:

```typescript
// Текущее расписание: каждый день в 9:00 AM
cron.schedule('0 9 * * *', () => {
  // ...
});

// Примеры других расписаний:
// '0 */6 * * *' - каждые 6 часов
// '0 9 * * 1-5' - только в рабочие дни в 9:00 AM
// '0 9,15 * * *' - в 9:00 AM и 3:00 PM
```
